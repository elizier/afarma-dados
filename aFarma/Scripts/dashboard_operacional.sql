Dashboard Operacional Beta--***Contagem de Pedidos por status***--(select   pedido.status as "Status", count(pedido.id) as "Contagem", translate(to_char((CAST(pedido.datapedido AS DATE)), 'MM-YYYY'),'-','/') as "Data", (EXTRACT(MONTH FROM pedido.datapedido)) as "Mês", (EXTRACT(YEAR FROM pedido.datapedido)) as "Ano"from pedidowhere 1=1[[and {{status}} ]][[ and  translate(to_char((CAST(pedido.datapedido AS DATE)), 'MM-YYYY'),'-','/') = {{data}} ]]group by pedido.status, translate(to_char((CAST(pedido.datapedido AS DATE)), 'MM-YYYY'),'-','/'), (EXTRACT(MONTH FROM pedido.datapedido)), (EXTRACT(YEAR FROM pedido.datapedido))order by (EXTRACT(YEAR FROM pedido.datapedido)), (EXTRACT(MONTH FROM pedido.datapedido)), translate(to_char((CAST(pedido.datapedido AS DATE)), 'MM-YYYY'),'-','/'))union all(select 'Total', count(pedido.id) , translate(to_char((CAST(pedido.datapedido AS DATE)), 'MM-YYYY'),'-','/') as "Data", (EXTRACT(MONTH FROM pedido.datapedido)) as "Mês", (EXTRACT(YEAR FROM pedido.datapedido)) as "Ano"from pedidowhere 1=1[[ and  translate(to_char((CAST(pedido.datapedido AS DATE)), 'MM-YYYY'),'-','/') = {{data}} ]]group by translate(to_char((CAST(pedido.datapedido AS DATE)), 'MM-YYYY'),'-','/'),(EXTRACT(MONTH FROM pedido.datapedido)), (EXTRACT(YEAR FROM pedido.datapedido))order by (EXTRACT(YEAR FROM pedido.datapedido)), (EXTRACT(MONTH FROM pedido.datapedido)), translate(to_char((CAST(pedido.datapedido AS DATE)), 'MM-YYYY'),'-','/'));--***Contagem de clientes cadastrados***--select count(*) from (select translate(UPPER(u.nome), 'áàâãäåaaaÁ ÃÄÅAAAÀéèêëeeeeeEEEÉEEÈìíîïìiiiÌÍÎÏÌIIIóôõöoooòÒÓÔÕÖOOOùúûüuuuuÙÚÛÜUUUUçÇñÑýÝ','aaaaaaaaaAAAAAAAAAeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIooooooooOOOOOOOOuuuuuuuuUUUUUUUUcCnNyY') as "Nome", replace(replace(u.cpf,'-',''),'.',''),translate(UPPER(e.cidade), 'áàâãäåaaaÁ ÃÄÅAAAÀéèêëeeeeeEEEÉEEÈìíîïìiiiÌÍÎÏÌIIIóôõöoooòÒÓÔÕÖOOOùúûüuuuuÙÚÛÜUUUUçÇñÑýÝ','aaaaaaaaaAAAAAAAAAeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIooooooooOOOOOOOOuuuuuuuuUUUUUUUUcCnNyY') as "Cidade", translate(UPPER(e.bairro), 'áàâãäåaaaÁ ÃÄÅAAAÀéèêëeeeeeEEEÉEEÈìíîïìiiiÌÍÎÏÌIIIóôõöoooòÒÓÔÕÖOOOùúûüuuuuÙÚÛÜUUUUçÇñÑýÝ','aaaaaaaaaAAAAAAAAAeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIooooooooOOOOOOOOuuuuuuuuUUUUUUUUcCnNyY') as "Bairro", replace(e.cep,'-','') as "CEP",replace(replace(replace(replace(u.telefone,')', ''), '(', ''),'-',''),' ', '') as "Telefone",  u.email as "Email"from usuario u, endereco e, endereco_usuario n where u.id = n.usuario_id and n.endereco_id = e.id and u.perfilid = '2' and u.ativo = truegroup by u.nome, replace(replace(u.cpf,'-',''),'.',''),translate(UPPER(e.cidade), 'áàâãäåaaaÁ ÃÄÅAAAÀéèêëeeeeeEEEÉEEÈìíîïìiiiÌÍÎÏÌIIIóôõöoooòÒÓÔÕÖOOOùúûüuuuuÙÚÛÜUUUUçÇñÑýÝ','aaaaaaaaaAAAAAAAAAeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIooooooooOOOOOOOOuuuuuuuuUUUUUUUUcCnNyY'),translate(UPPER(e.bairro), 'áàâãäåaaaÁ ÃÄÅAAAÀéèêëeeeeeEEEÉEEÈìíîïìiiiÌÍÎÏÌIIIóôõöoooòÒÓÔÕÖOOOùúûüuuuuÙÚÛÜUUUUçÇñÑýÝ','aaaaaaaaaAAAAAAAAAeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIooooooooOOOOOOOOuuuuuuuuUUUUUUUUcCnNyY'), replace(e.cep,'-',''), replace(replace(replace(replace(u.telefone,')', ''), '(', ''),'-',''),' ', ''),  u.email) as "filtro";--***Local com mais pedidos***--select filtro.local from (select translate(UPPER(concat(e.bairro,'-',e.cidade)), 'áàâãäåaaaÁ ÃÄÅAAAÀéèêëeeeeeEEEÉEEÈìíîïìiiiÌÍÎÏÌIIIóôõöoooòÒÓÔÕÖOOOùúûüuuuuÙÚÛÜUUUUçÇñÑýÝ','aaaaaaaaaAAAAAAAAAeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIooooooooOOOOOOOOuuuuuuuuUUUUUUUUcCnNyY') as Local , count(p.id)from pedido p, endereco e where p.endereco_id = e.id and p.endereco_id != ''group by translate(UPPER(e.cidade), 'áàâãäåaaaÁ ÃÄÅAAAÀéèêëeeeeeEEEÉEEÈìíîïìiiiÌÍÎÏÌIIIóôõöoooòÒÓÔÕÖOOOùúûüuuuuÙÚÛÜUUUUçÇñÑýÝ','aaaaaaaaaAAAAAAAAAeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIooooooooOOOOOOOOuuuuuuuuUUUUUUUUcCnNyY'), translate(UPPER(e.bairro), 'áàâãäåaaaÁ ÃÄÅAAAÀéèêëeeeeeEEEÉEEÈìíîïìiiiÌÍÎÏÌIIIóôõöoooòÒÓÔÕÖOOOùúûüuuuuÙÚÛÜUUUUçÇñÑýÝ','aaaaaaaaaAAAAAAAAAeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIooooooooOOOOOOOOuuuuuuuuUUUUUUUUcCnNyY'), translate(UPPER(concat(e.bairro,'-',e.cidade)), 'áàâãäåaaaÁ ÃÄÅAAAÀéèêëeeeeeEEEÉEEÈìíîïìiiiÌÍÎÏÌIIIóôõöoooòÒÓÔÕÖOOOùúûüuuuuÙÚÛÜUUUUçÇñÑýÝ','aaaaaaaaaAAAAAAAAAeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIooooooooOOOOOOOOuuuuuuuuUUUUUUUUcCnNyY')order by count(p.id) desclimit 1) as filtro;--***Produto mais pedido***--select filtro.concat from (Select r.nome,count(p.id), concat(r.nome,' ','-',' ',count(p.id),' ','pedidos') FROM cesta c, pedido p, item_cesta i, itemprodutocesta t, produto r, usuario u where p.cesta_id = c.id and c.cliente_id = u.id and  c.id =i.cesta_id and i.item_id = t.id and t.produto_id = r.id and p.loja_id != ''group by r.nome order by count(p.id) desc limit 1) as filtro;--***Contagem de Pedidos por status por dia***--(select   pedido.status as "Status", count(pedido.id) as "Contagem", (CAST(pedido.datapedido AS DATE)) as "Data", concat((EXTRACT(MONTH FROM pedido.datapedido)),'/',(EXTRACT(YEAR FROM pedido.datapedido))) "Mês"from pedidowhere 1=1[[and {{status}} ]][[ and translate(to_char((CAST(pedido.datapedido AS DATE)), 'MM-YYYY'),'-','/') = {{data}} ]]group by pedido.status, (CAST(pedido.datapedido AS DATE)), concat((EXTRACT(MONTH FROM pedido.datapedido)),'/',(EXTRACT(YEAR FROM pedido.datapedido)))order by (CAST(pedido.datapedido AS DATE)))union all(select 'Total', count(pedido.id) as "Contagem", (CAST(pedido.datapedido AS DATE)) as "Data", concat((EXTRACT(MONTH FROM pedido.datapedido)),'/',(EXTRACT(YEAR FROM pedido.datapedido))) "Mês"from pedidowhere 1=1[[ and translate(to_char((CAST(pedido.datapedido AS DATE)), 'MM-YYYY'),'-','/') = {{data}} ]]group by (CAST(pedido.datapedido AS DATE)), concat((EXTRACT(MONTH FROM pedido.datapedido)),'/',(EXTRACT(YEAR FROM pedido.datapedido))));--Contagem de Pedidos Fora da área de atendimento por bairroselect pedido.status as "Status do Atendimento", translate(UPPER(e.cidade), 'áàâãäåaaaÁ ÃÄÅAAAÀéèêëeeeeeEEEÉEEÈìíîïìiiiÌÍÎÏÌIIIóôõöoooòÒÓÔÕÖOOOùúûüuuuuÙÚÛÜUUUUçÇñÑýÝ','aaaaaaaaaAAAAAAAAAeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIooooooooOOOOOOOOuuuuuuuuUUUUUUUUcCnNyY') as "Cidade",translate(UPPER(e.bairro), 'áàâãäåaaaÁ ÃÄÅAAAÀéèêëeeeeeEEEÉEEÈìíîïìiiiÌÍÎÏÌIIIóôõöoooòÒÓÔÕÖOOOùúûüuuuuÙÚÛÜUUUUçÇñÑýÝ','aaaaaaaaaAAAAAAAAAeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIooooooooOOOOOOOOuuuuuuuuUUUUUUUUcCnNyY') as "Bairro",count(pedido.id) as "Número de Pedidos"from pedido, endereco e where [[ translate(UPPER(e.cidade), 'áàâãäåaaaÁ ÃÄÅAAAÀéèêëeeeeeEEEÉEEÈìíîïìiiiÌÍÎÏÌIIIóôõöoooòÒÓÔÕÖOOOùúûüuuuuÙÚÛÜUUUUçÇñÑýÝ','aaaaaaaaaAAAAAAAAAeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIooooooooOOOOOOOOuuuuuuuuUUUUUUUUcCnNyY') = translate(UPPER({{cidade}}), 'áàâãäåaaaÁ ÃÄÅAAAÀéèêëeeeeeEEEÉEEÈìíîïìiiiÌÍÎÏÌIIIóôõöoooòÒÓÔÕÖOOOùúûüuuuuÙÚÛÜUUUUçÇñÑýÝ','aaaaaaaaaAAAAAAAAAeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIooooooooOOOOOOOOuuuuuuuuUUUUUUUUcCnNyY') and]] pedido.status = 'FORA_DA_AREA_DE_ATENDIMENTO'and e.id = pedido.endereco_id [[ and translate(to_char((CAST(pedido.datapedido AS DATE)), 'MM-YYYY'),'-','/') = {{data}} ]]group by pedido.status,translate(UPPER(e.cidade), 'áàâãäåaaaÁ ÃÄÅAAAÀéèêëeeeeeEEEÉEEÈìíîïìiiiÌÍÎÏÌIIIóôõöoooòÒÓÔÕÖOOOùúûüuuuuÙÚÛÜUUUUçÇñÑýÝ','aaaaaaaaaAAAAAAAAAeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIooooooooOOOOOOOOuuuuuuuuUUUUUUUUcCnNyY'),translate(UPPER(e.bairro), 'áàâãäåaaaÁ ÃÄÅAAAÀéèêëeeeeeEEEÉEEÈìíîïìiiiÌÍÎÏÌIIIóôõöoooòÒÓÔÕÖOOOùúûüuuuuÙÚÛÜUUUUçÇñÑýÝ',   'aaaaaaaaaAAAAAAAAAeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIooooooooOOOOOOOOuuuuuuuuUUUUUUUUcCnNyY')order by count(pedido.id) desclimit 10;--***Contagem de pedidos por bairro sem Derick***--select TRIM(translate(UPPER(e.cidade), 'áàâãäåaaaÁ ÃÄÅAAAÀéèêëeeeeeEEEÉEEÈìíîïìiiiÌÍÎÏÌIIIóôõöoooòÒÓÔÕÖOOOùúûüuuuuÙÚÛÜUUUUçÇñÑýÝ','aaaaaaaaaAAAAAAAAAeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIooooooooOOOOOOOOuuuuuuuuUUUUUUUUcCnNyY')) as "Cidade",TRIM(translate(UPPER(e.bairro), 'áàâãäåaaaÁ ÃÄÅAAAÀéèêëeeeeeEEEÉEEÈìíîïìiiiÌÍÎÏÌIIIóôõöoooòÒÓÔÕÖOOOùúûüuuuuÙÚÛÜUUUUçÇñÑýÝ','aaaaaaaaaAAAAAAAAAeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIooooooooOOOOOOOOuuuuuuuuUUUUUUUUcCnNyY')) as "Bairro", count(pedido.id) as "Contagem"from endereco e, pedido , cesta c, usuario uwhere pedido.endereco_id = e.id and pedido.cesta_id = c.id and c.cliente_id = u.id  and pedido.motivorejeicao != 'DDD' and pedido.motivorejeicao != 'TESTE+DERICK' and replace(replace(u.cpf,'-',''),'.','') not like '12511001713'[[ and TRIM(translate(UPPER(e.cidade), 'áàâãäåaaaÁ ÃÄÅAAAÀéèêëeeeeeEEEÉEEÈìíîïìiiiÌÍÎÏÌIIIóôõöoooòÒÓÔÕÖOOOùúûüuuuuÙÚÛÜUUUUçÇñÑýÝ','aaaaaaaaaAAAAAAAAAeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIooooooooOOOOOOOOuuuuuuuuUUUUUUUUcCnNyY')) = TRIM(translate(UPPER({{cidade}}), 'áàâãäåaaaÁ ÃÄÅAAAÀéèêëeeeeeEEEÉEEÈìíîïìiiiÌÍÎÏÌIIIóôõöoooòÒÓÔÕÖOOOùúûüuuuuÙÚÛÜUUUUçÇñÑýÝ','aaaaaaaaaAAAAAAAAAeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIooooooooOOOOOOOOuuuuuuuuUUUUUUUUcCnNyY')) and]] [[ and translate(to_char((CAST(pedido.datapedido AS DATE)), 'MM-YYYY'),'-','/') = {{data}} ]]group by TRIM(translate(UPPER(e.cidade), 'áàâãäåaaaÁ ÃÄÅAAAÀéèêëeeeeeEEEÉEEÈìíîïìiiiÌÍÎÏÌIIIóôõöoooòÒÓÔÕÖOOOùúûüuuuuÙÚÛÜUUUUçÇñÑýÝ','aaaaaaaaaAAAAAAAAAeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIooooooooOOOOOOOOuuuuuuuuUUUUUUUUcCnNyY')),TRIM(translate(UPPER(e.bairro), 'áàâãäåaaaÁ ÃÄÅAAAÀéèêëeeeeeEEEÉEEÈìíîïìiiiÌÍÎÏÌIIIóôõöoooòÒÓÔÕÖOOOùúûüuuuuÙÚÛÜUUUUçÇñÑýÝ','aaaaaaaaaAAAAAAAAAeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIooooooooOOOOOOOOuuuuuuuuUUUUUUUUcCnNyY'))order by count(pedido.id) desclimit 10;--***Contagem por motvivo da rejeição***--select replace(translate(UPPER(p.motivorejeicao), 'áàâãäåaaaÁ ÃÄÅAAAÀéèêëeeeeeEEEÉEEÈìíîïìiiiÌÍÎÏÌIIIóôõöoooòÒÓÔÕÖOOOùúûüuuuuÙÚÛÜUUUUçÇñÑýÝ','aaaaaaaaaAAAAAAAAAeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIooooooooOOOOOOOOuuuuuuuuUUUUUUUUcCnNyY'),'.','')  as "Motivo", count(p.id) as "Contagem"from pedido p, cesta c, usuario u, item_cesta ic, itemprodutocesta i, produto prwhere p.cesta_id = c.id and c.id = ic.cesta_id and ic.item_id = i.id and i.produto_id = pr.id and c.cliente_id = u.idand u.perfilid = '2'and p.status = 'REJEITADO' and p.motivorejeicao != 'DDD' and p.motivorejeicao != 'TESTE+DERICK'group by replace(translate(UPPER(p.motivorejeicao), 'áàâãäåaaaÁ ÃÄÅAAAÀéèêëeeeeeEEEÉEEÈìíîïìiiiÌÍÎÏÌIIIóôõöoooòÒÓÔÕÖOOOùúûüuuuuÙÚÛÜUUUUçÇñÑýÝ','aaaaaaaaaAAAAAAAAAeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIooooooooOOOOOOOOuuuuuuuuUUUUUUUUcCnNyY'),'.','')ORDER BY max(p.datapedido);--***Contagem de pedidos rejeitados por usuário***--select translate(UPPER(u.nome), 'áàâãäåaaaÁ ÃÄÅAAAÀéèêëeeeeeEEEÉEEÈìíîïìiiiÌÍÎÏÌIIIóôõöoooòÒÓÔÕÖOOOùúûüuuuuÙÚÛÜUUUUçÇñÑýÝ','aaaaaaaaaAAAAAAAAAeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIooooooooOOOOOOOOuuuuuuuuUUUUUUUUcCnNyY') as "Usuário",translate(UPPER(e.cidade), 'áàâãäåaaaÁ ÃÄÅAAAÀéèêëeeeeeEEEÉEEÈìíîïìiiiÌÍÎÏÌIIIóôõöoooòÒÓÔÕÖOOOùúûüuuuuÙÚÛÜUUUUçÇñÑýÝ','aaaaaaaaaAAAAAAAAAeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIooooooooOOOOOOOOuuuuuuuuUUUUUUUUcCnNyY') as "Cidade", translate(UPPER(e.bairro), 'áàâãäåaaaÁ ÃÄÅAAAÀéèêëeeeeeEEEÉEEÈìíîïìiiiÌÍÎÏÌIIIóôõöoooòÒÓÔÕÖOOOùúûüuuuuÙÚÛÜUUUUçÇñÑýÝ','aaaaaaaaaAAAAAAAAAeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIooooooooOOOOOOOOuuuuuuuuUUUUUUUUcCnNyY') as "Bairro",  replace(translate(UPPER(p.motivorejeicao), 'áàâãäåaaaÁ ÃÄÅAAAÀéèêëeeeeeEEEÉEEÈìíîïìiiiÌÍÎÏÌIIIóôõöoooòÒÓÔÕÖOOOùúûüuuuuÙÚÛÜUUUUçÇñÑýÝ','aaaaaaaaaAAAAAAAAAeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIooooooooOOOOOOOOuuuuuuuuUUUUUUUUcCnNyY'),'.','') as "Motivo", UPPER(l.razaosocial) as "Loja",  max(p.datapedido) as "Último pedido", u.telefone as "Telefone"from pedido p, cesta c, usuario u, item_cesta ic, itemprodutocesta i, endereco e, loja lwhere [[ translate(UPPER(u.nome), 'áàâãäåaaaÁ ÃÄÅAAAÀéèêëeeeeeEEEÉEEÈìíîïìiiiÌÍÎÏÌIIIóôõöoooòÒÓÔÕÖOOOùúûüuuuuÙÚÛÜUUUUçÇñÑýÝ','aaaaaaaaaAAAAAAAAAeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIooooooooOOOOOOOOuuuuuuuuUUUUUUUUcCnNyY') like translate(UPPER(concat('%',{{nome}},'%')), 'áàâãäåaaaÁ ÃÄÅAAAÀéèêëeeeeeEEEÉEEÈìíîïìiiiÌÍÎÏÌIIIóôõöoooòÒÓÔÕÖOOOùúûüuuuuÙÚÛÜUUUUçÇñÑýÝ','aaaaaaaaaAAAAAAAAAeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIooooooooOOOOOOOOuuuuuuuuUUUUUUUUcCnNyY')  and]] [[ translate(UPPER(e.cidade), 'áàâãäåaaaÁ ÃÄÅAAAÀéèêëeeeeeEEEÉEEÈìíîïìiiiÌÍÎÏÌIIIóôõöoooòÒÓÔÕÖOOOùúûüuuuuÙÚÛÜUUUUçÇñÑýÝ','aaaaaaaaaAAAAAAAAAeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIooooooooOOOOOOOOuuuuuuuuUUUUUUUUcCnNyY') = translate(UPPER({{cidade}}), 'áàâãäåaaaÁ ÃÄÅAAAÀéèêëeeeeeEEEÉEEÈìíîïìiiiÌÍÎÏÌIIIóôõöoooòÒÓÔÕÖOOOùúûüuuuuÙÚÛÜUUUUçÇñÑýÝ','aaaaaaaaaAAAAAAAAAeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIooooooooOOOOOOOOuuuuuuuuUUUUUUUUcCnNyY') and]] p.cesta_id = c.id and c.id = ic.cesta_id and ic.item_id = i.id and p.endereco_id=e.id and p.loja_id = l.idand c.cliente_id = u.idand u.perfilid = '2'and p.status = 'REJEITADO' and p.motivorejeicao != 'DDD' and p.motivorejeicao != 'TESTE+DERICK'group by u.nome , p.status, u.telefone,translate(UPPER(e.cidade), 'áàâãäåaaaÁ ÃÄÅAAAÀéèêëeeeeeEEEÉEEÈìíîïìiiiÌÍÎÏÌIIIóôõöoooòÒÓÔÕÖOOOùúûüuuuuÙÚÛÜUUUUçÇñÑýÝ','aaaaaaaaaAAAAAAAAAeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIooooooooOOOOOOOOuuuuuuuuUUUUUUUUcCnNyY'), translate(UPPER(e.bairro), 'áàâãäåaaaÁ ÃÄÅAAAÀéèêëeeeeeEEEÉEEÈìíîïìiiiÌÍÎÏÌIIIóôõöoooòÒÓÔÕÖOOOùúûüuuuuÙÚÛÜUUUUçÇñÑýÝ','aaaaaaaaaAAAAAAAAAeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIooooooooOOOOOOOOuuuuuuuuUUUUUUUUcCnNyY'),  replace(translate(UPPER(p.motivorejeicao), 'áàâãäåaaaÁ ÃÄÅAAAÀéèêëeeeeeEEEÉEEÈìíîïìiiiÌÍÎÏÌIIIóôõöoooòÒÓÔÕÖOOOùúûüuuuuÙÚÛÜUUUUçÇñÑýÝ','aaaaaaaaaAAAAAAAAAeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIooooooooOOOOOOOOuuuuuuuuUUUUUUUUcCnNyY'),'.',''), l.razaosocialORDER BY max(p.datapedido) desc;--***Contagem de pedidos rejeitados por usuário***--select translate(UPPER(u.nome), 'áàâãäåaaaÁ ÃÄÅAAAÀéèêëeeeeeEEEÉEEÈìíîïìiiiÌÍÎÏÌIIIóôõöoooòÒÓÔÕÖOOOùúûüuuuuÙÚÛÜUUUUçÇñÑýÝ','aaaaaaaaaAAAAAAAAAeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIooooooooOOOOOOOOuuuuuuuuUUUUUUUUcCnNyY') as "Usuário", pr.nome as "Produto", p.status as "Status do pedido", replace(translate(UPPER(p.motivorejeicao), 'áàâãäåaaaÁ ÃÄÅAAAÀéèêëeeeeeEEEÉEEÈìíîïìiiiÌÍÎÏÌIIIóôõöoooòÒÓÔÕÖOOOùúûüuuuuÙÚÛÜUUUUçÇñÑýÝ','aaaaaaaaaAAAAAAAAAeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIooooooooOOOOOOOOuuuuuuuuUUUUUUUUcCnNyY'),'.','') as "Motivo", max(p.datapedido) as "Último pedido", u.telefone as "Telefone"from pedido p, cesta c, usuario u, item_cesta ic, itemprodutocesta i, produto prwhere [[ translate(UPPER(u.nome), 'áàâãäåaaaÁ ÃÄÅAAAÀéèêëeeeeeEEEÉEEÈìíîïìiiiÌÍÎÏÌIIIóôõöoooòÒÓÔÕÖOOOùúûüuuuuÙÚÛÜUUUUçÇñÑýÝ','aaaaaaaaaAAAAAAAAAeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIooooooooOOOOOOOOuuuuuuuuUUUUUUUUcCnNyY') like translate(UPPER(concat('%',{{nome}},'%')), 'áàâãäåaaaÁ ÃÄÅAAAÀéèêëeeeeeEEEÉEEÈìíîïìiiiÌÍÎÏÌIIIóôõöoooòÒÓÔÕÖOOOùúûüuuuuÙÚÛÜUUUUçÇñÑýÝ','aaaaaaaaaAAAAAAAAAeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIooooooooOOOOOOOOuuuuuuuuUUUUUUUUcCnNyY')  and]]p.cesta_id = c.id and c.id = ic.cesta_id and ic.item_id = i.id and i.produto_id = pr.id and c.cliente_id = u.idand u.perfilid = '2'and p.status = 'EM_ATENDIMENTO' group by u.nome , pr.nome, p.status, u.telefone,  replace(translate(UPPER(p.motivorejeicao), 'áàâãäåaaaÁ ÃÄÅAAAÀéèêëeeeeeEEEÉEEÈìíîïìiiiÌÍÎÏÌIIIóôõöoooòÒÓÔÕÖOOOùúûüuuuuÙÚÛÜUUUUçÇñÑýÝ','aaaaaaaaaAAAAAAAAAeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIooooooooOOOOOOOOuuuuuuuuUUUUUUUUcCnNyY'),'.','')ORDER BY max(p.datapedido);--***Contagem de pedidos Entregues por usuário***--select translate(UPPER(u.nome), 'áàâãäåaaaÁ ÃÄÅAAAÀéèêëeeeeeEEEÉEEÈìíîïìiiiÌÍÎÏÌIIIóôõöoooòÒÓÔÕÖOOOùúûüuuuuÙÚÛÜUUUUçÇñÑýÝ','aaaaaaaaaAAAAAAAAAeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIooooooooOOOOOOOOuuuuuuuuUUUUUUUUcCnNyY') as "Usuário", pr.nome as "Produto",UPPER(l.razaosocial) as "Loja", p.status as "Status do pedido", max(p.datapedido) as "Último pedido", u.telefone as "Telefone"from pedido p, cesta c, usuario u, item_cesta ic, itemprodutocesta i, produto pr, loja lwhere [[ translate(UPPER(u.nome), 'áàâãäåaaaÁ ÃÄÅAAAÀéèêëeeeeeEEEÉEEÈìíîïìiiiÌÍÎÏÌIIIóôõöoooòÒÓÔÕÖOOOùúûüuuuuÙÚÛÜUUUUçÇñÑýÝ','aaaaaaaaaAAAAAAAAAeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIooooooooOOOOOOOOuuuuuuuuUUUUUUUUcCnNyY') like translate(UPPER(concat('%',{{nome}},'%')), 'áàâãäåaaaÁ ÃÄÅAAAÀéèêëeeeeeEEEÉEEÈìíîïìiiiÌÍÎÏÌIIIóôõöoooòÒÓÔÕÖOOOùúûüuuuuÙÚÛÜUUUUçÇñÑýÝ','aaaaaaaaaAAAAAAAAAeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIooooooooOOOOOOOOuuuuuuuuUUUUUUUUcCnNyY')  and]]p.cesta_id = c.id and c.id = ic.cesta_id and ic.item_id = i.id and i.produto_id = pr.id and p.loja_id=l.idand c.cliente_id = u.idand u.perfilid = '2'and p.status = 'ENTREGUE' group by u.nome , pr.nome, p.status, u.telefone,  replace(translate(UPPER(p.motivorejeicao), 'áàâãäåaaaÁ ÃÄÅAAAÀéèêëeeeeeEEEÉEEÈìíîïìiiiÌÍÎÏÌIIIóôõöoooòÒÓÔÕÖOOOùúûüuuuuÙÚÛÜUUUUçÇñÑýÝ','aaaaaaaaaAAAAAAAAAeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIooooooooOOOOOOOOuuuuuuuuUUUUUUUUcCnNyY'),'.',''),UPPER(l.razaosocial)ORDER BY max(p.datapedido) desc;--***Usuários Cadastrados***--select translate(UPPER(u.nome), 'áàâãäåaaaÁ ÃÄÅAAAÀéèêëeeeeeEEEÉEEÈìíîïìiiiÌÍÎÏÌIIIóôõöoooòÒÓÔÕÖOOOùúûüuuuuÙÚÛÜUUUUçÇñÑýÝ','aaaaaaaaaAAAAAAAAAeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIooooooooOOOOOOOOuuuuuuuuUUUUUUUUcCnNyY') as "Nome", replace(replace(u.cpf,'-',''),'.','') as "CPF",translate(UPPER(e.cidade), 'áàâãäåaaaÁ ÃÄÅAAAÀéèêëeeeeeEEEÉEEÈìíîïìiiiÌÍÎÏÌIIIóôõöoooòÒÓÔÕÖOOOùúûüuuuuÙÚÛÜUUUUçÇñÑýÝ','aaaaaaaaaAAAAAAAAAeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIooooooooOOOOOOOOuuuuuuuuUUUUUUUUcCnNyY') as "Cidade", translate(UPPER(e.bairro), 'áàâãäåaaaÁ ÃÄÅAAAÀéèêëeeeeeEEEÉEEÈìíîïìiiiÌÍÎÏÌIIIóôõöoooòÒÓÔÕÖOOOùúûüuuuuÙÚÛÜUUUUçÇñÑýÝ','aaaaaaaaaAAAAAAAAAeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIooooooooOOOOOOOOuuuuuuuuUUUUUUUUcCnNyY') as "Bairro", replace(e.cep,'-','') as "CEP",replace(replace(replace(replace(u.telefone,')', ''), '(', ''),'-',''),' ', '') as "Telefone",  u.email as "Email"from usuario u, endereco e, endereco_usuario nwhere [[ translate(UPPER(u.nome), 'áàâãäåaaaÁ ÃÄÅAAAÀéèêëeeeeeEEEÉEEÈìíîïìiiiÌÍÎÏÌIIIóôõöoooòÒÓÔÕÖOOOùúûüuuuuÙÚÛÜUUUUçÇñÑýÝ','aaaaaaaaaAAAAAAAAAeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIooooooooOOOOOOOOuuuuuuuuUUUUUUUUcCnNyY') like translate(UPPER(concat('%',{{nome}},'%')), 'áàâãäåaaaÁ ÃÄÅAAAÀéèêëeeeeeEEEÉEEÈìíîïìiiiÌÍÎÏÌIIIóôõöoooòÒÓÔÕÖOOOùúûüuuuuÙÚÛÜUUUUçÇñÑýÝ','aaaaaaaaaAAAAAAAAAeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIooooooooOOOOOOOOuuuuuuuuUUUUUUUUcCnNyY')  and]] [[ translate(UPPER(e.cidade), 'áàâãäåaaaÁ ÃÄÅAAAÀéèêëeeeeeEEEÉEEÈìíîïìiiiÌÍÎÏÌIIIóôõöoooòÒÓÔÕÖOOOùúûüuuuuÙÚÛÜUUUUçÇñÑýÝ','aaaaaaaaaAAAAAAAAAeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIooooooooOOOOOOOOuuuuuuuuUUUUUUUUcCnNyY') = translate(UPPER({{cidade}}), 'áàâãäåaaaÁ ÃÄÅAAAÀéèêëeeeeeEEEÉEEÈìíîïìiiiÌÍÎÏÌIIIóôõöoooòÒÓÔÕÖOOOùúûüuuuuÙÚÛÜUUUUçÇñÑýÝ','aaaaaaaaaAAAAAAAAAeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIooooooooOOOOOOOOuuuuuuuuUUUUUUUUcCnNyY') and]] u.id = n.usuario_id and n.endereco_id = e.id and u.perfilid = '2' and u.ativo = truegroup by u.nome, replace(replace(u.cpf,'-',''),'.',''),translate(UPPER(e.cidade), 'áàâãäåaaaÁ ÃÄÅAAAÀéèêëeeeeeEEEÉEEÈìíîïìiiiÌÍÎÏÌIIIóôõöoooòÒÓÔÕÖOOOùúûüuuuuÙÚÛÜUUUUçÇñÑýÝ','aaaaaaaaaAAAAAAAAAeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIooooooooOOOOOOOOuuuuuuuuUUUUUUUUcCnNyY'),translate(UPPER(e.bairro), 'áàâãäåaaaÁ ÃÄÅAAAÀéèêëeeeeeEEEÉEEÈìíîïìiiiÌÍÎÏÌIIIóôõöoooòÒÓÔÕÖOOOùúûüuuuuÙÚÛÜUUUUçÇñÑýÝ','aaaaaaaaaAAAAAAAAAeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIooooooooOOOOOOOOuuuuuuuuUUUUUUUUcCnNyY'), replace(e.cep,'-',''), replace(replace(replace(replace(u.telefone,')', ''), '(', ''),'-',''),' ', ''),  u.emailorder by u.nome;select translate(UPPER(u.nome), 'áàâãäåaaaÁ ÃÄÅAAAÀéèêëeeeeeEEEÉEEÈìíîïìiiiÌÍÎÏÌIIIóôõöoooòÒÓÔÕÖOOOùúûüuuuuÙÚÛÜUUUUçÇñÑýÝ','aaaaaaaaaAAAAAAAAAeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIooooooooOOOOOOOOuuuuuuuuUUUUUUUUcCnNyY') as "Usuário", pr.nome as "Produto", p.status as "Status do pedido", max(p.datapedido) as "Último pedido", DATE_PART('day', (now()) - (max(p.datapedido))) as  "Dias sem Pedir", u.telefone as "Telefone"from pedido p, cesta c, usuario u, item_cesta ic, itemprodutocesta i, produto prwhere p.cesta_id = c.id and c.id = ic.cesta_id and ic.item_id = i.id and i.produto_id = pr.id and c.cliente_id = u.idand u.perfilid = '2'and p.status = 'ENTREGUE'[[ and translate(UPPER(u.nome), 'áàâãäåaaaÁ ÃÄÅAAAÀéèêëeeeeeEEEÉEEÈìíîïìiiiÌÍÎÏÌIIIóôõöoooòÒÓÔÕÖOOOùúûüuuuuÙÚÛÜUUUUçÇñÑýÝ','aaaaaaaaaAAAAAAAAAeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIooooooooOOOOOOOOuuuuuuuuUUUUUUUUcCnNyY') like translate(UPPER(concat('%',{{nome}},'%')), 'áàâãäåaaaÁ ÃÄÅAAAÀéèêëeeeeeEEEÉEEÈìíîïìiiiÌÍÎÏÌIIIóôõöoooòÒÓÔÕÖOOOùúûüuuuuÙÚÛÜUUUUçÇñÑýÝ','aaaaaaaaaAAAAAAAAAeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIooooooooOOOOOOOOuuuuuuuuUUUUUUUUcCnNyY')  ]]group by u.nome , pr.nome, p.status, u.telefoneorder by DATE_PART('day', (now()) - (max(p.datapedido))) desc, u.nome asc;(select perfil.identificador as "Perfil", count(usuario.id) as "Contagem", translate(to_char((CAST(usuario.dataaceite AS DATE)), 'MM-YYYY'),'-','/') as "Data", (EXTRACT(MONTH FROM usuario.dataaceite)) as "Mês", (EXTRACT(YEAR FROM usuario.dataaceite)) as "Ano"from usuario, perfilwhere perfil.id=usuario.perfilid and usuario.perfilid!=5 and usuario.perfilid!=1[[and {{Perfil}} ]][[ and  translate(to_char((CAST(usuario.dataaceite AS DATE)), 'MM-YYYY'),'-','/') = {{data}} ]]group by  perfil.identificador, translate(to_char((CAST(usuario.dataaceite AS DATE)), 'MM-YYYY'),'-','/'), (EXTRACT(MONTH FROM usuario.dataaceite)), (EXTRACT(YEAR FROM usuario.dataaceite))order by (EXTRACT(YEAR FROM usuario.dataaceite)), (EXTRACT(MONTH FROM usuario.dataaceite)), translate(to_char((CAST(usuario.dataaceite AS DATE)), 'MM-YYYY'),'-','/'))union all(select 'Total', count(usuario.id) , translate(to_char((CAST(usuario.dataaceite AS DATE)), 'MM-YYYY'),'-','/') as "Data", (EXTRACT(MONTH FROM usuario.dataaceite)) as "Mês", (EXTRACT(YEAR FROM usuario.dataaceite)) as "Ano"from usuariowhere 1=1[[ and  translate(to_char((CAST(usuario.dataaceite AS DATE)), 'MM-YYYY'),'-','/') = {{data}} ]]group by translate(to_char((CAST(usuario.dataaceite AS DATE)), 'MM-YYYY'),'-','/'),(EXTRACT(MONTH FROM usuario.dataaceite)), (EXTRACT(YEAR FROM usuario.dataaceite))order by (EXTRACT(YEAR FROM usuario.dataaceite)), (EXTRACT(MONTH FROM usuario.dataaceite)), translate(to_char((CAST(usuario.dataaceite AS DATE)), 'MM-YYYY'),'-','/'));--***Contagem de pedidos por bairro***--select TRIM(translate(UPPER(e.cidade), 'áàâãäåaaaÁ ÃÄÅAAAÀéèêëeeeeeEEEÉEEÈìíîïìiiiÌÍÎÏÌIIIóôõöoooòÒÓÔÕÖOOOùúûüuuuuÙÚÛÜUUUUçÇñÑýÝ','aaaaaaaaaAAAAAAAAAeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIooooooooOOOOOOOOuuuuuuuuUUUUUUUUcCnNyY')) as "Cidade",TRIM(translate(UPPER(e.bairro), 'áàâãäåaaaÁ ÃÄÅAAAÀéèêëeeeeeEEEÉEEÈìíîïìiiiÌÍÎÏÌIIIóôõöoooòÒÓÔÕÖOOOùúûüuuuuÙÚÛÜUUUUçÇñÑýÝ','aaaaaaaaaAAAAAAAAAeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIooooooooOOOOOOOOuuuuuuuuUUUUUUUUcCnNyY')) as "Bairro", count(pedido.id) as "Contagem"from endereco e, pedidowhere [[ TRIM(translate(UPPER(e.cidade), 'áàâãäåaaaÁ ÃÄÅAAAÀéèêëeeeeeEEEÉEEÈìíîïìiiiÌÍÎÏÌIIIóôõöoooòÒÓÔÕÖOOOùúûüuuuuÙÚÛÜUUUUçÇñÑýÝ','aaaaaaaaaAAAAAAAAAeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIooooooooOOOOOOOOuuuuuuuuUUUUUUUUcCnNyY')) = TRIM(translate(UPPER({{cidade}}), 'áàâãäåaaaÁ ÃÄÅAAAÀéèêëeeeeeEEEÉEEÈìíîïìiiiÌÍÎÏÌIIIóôõöoooòÒÓÔÕÖOOOùúûüuuuuÙÚÛÜUUUUçÇñÑýÝ','aaaaaaaaaAAAAAAAAAeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIooooooooOOOOOOOOuuuuuuuuUUUUUUUUcCnNyY')) and]] pedido.endereco_id = e.id and pedido.status != 'FORA_DA_AREA_DE_ATENDIMENTO' [[ and translate(to_char((CAST(pedido.datapedido AS DATE)), 'MM-YYYY'),'-','/') = {{data}} ]]group by TRIM(translate(UPPER(e.cidade), 'áàâãäåaaaÁ ÃÄÅAAAÀéèêëeeeeeEEEÉEEÈìíîïìiiiÌÍÎÏÌIIIóôõöoooòÒÓÔÕÖOOOùúûüuuuuÙÚÛÜUUUUçÇñÑýÝ','aaaaaaaaaAAAAAAAAAeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIooooooooOOOOOOOOuuuuuuuuUUUUUUUUcCnNyY')),TRIM(translate(UPPER(e.bairro), 'áàâãäåaaaÁ ÃÄÅAAAÀéèêëeeeeeEEEÉEEÈìíîïìiiiÌÍÎÏÌIIIóôõöoooòÒÓÔÕÖOOOùúûüuuuuÙÚÛÜUUUUçÇñÑýÝ','aaaaaaaaaAAAAAAAAAeeeeeeeeeEEEEEEEiiiiiiiiIIIIIIIIooooooooOOOOOOOOuuuuuuuuUUUUUUUUcCnNyY'))order by count(pedido.id) asclimit 10;(select perfil.identificador as "Perfil", count(usuario.id) as "Contagem",(CAST(usuario.dataaceite AS DATE)) as "Data", translate(to_char((CAST(usuario.dataaceite AS DATE)), 'MM-YYYY'),'-','/') as "Data",  (EXTRACT(MONTH FROM usuario.dataaceite)) as "Mês", (EXTRACT(YEAR FROM usuario.dataaceite)) as "Ano"from usuario, perfilwhere perfil.id=usuario.perfilid and usuario.perfilid!=5 and usuario.perfilid!=1[[and {{Perfil}} ]][[ and  translate(to_char((CAST(usuario.dataaceite AS DATE)), 'MM-YYYY'),'-','/') = {{data}} ]]group by (CAST(usuario.dataaceite AS DATE)), perfil.identificador, translate(to_char((CAST(usuario.dataaceite AS DATE)), 'MM-YYYY'),'-','/'), (EXTRACT(MONTH FROM usuario.dataaceite)), (EXTRACT(YEAR FROM usuario.dataaceite))order by (EXTRACT(YEAR FROM usuario.dataaceite)), (EXTRACT(MONTH FROM usuario.dataaceite)), translate(to_char((CAST(usuario.dataaceite AS DATE)), 'MM-YYYY'),'-','/'))union all(select 'Total', count(usuario.id) , (CAST(usuario.dataaceite AS DATE)), translate(to_char((CAST(usuario.dataaceite AS DATE)), 'MM-YYYY'),'-','/') as "Data", (EXTRACT(MONTH FROM usuario.dataaceite)) as "Mês", (EXTRACT(YEAR FROM usuario.dataaceite)) as "Ano"from usuariowhere 1=1[[ and  translate(to_char((CAST(usuario.dataaceite AS DATE)), 'MM-YYYY'),'-','/') = {{data}} ]]group by translate(to_char((CAST(usuario.dataaceite AS DATE)), 'MM-YYYY'),'-','/'),(EXTRACT(MONTH FROM usuario.dataaceite)), (EXTRACT(YEAR FROM usuario.dataaceite)), (CAST(usuario.dataaceite AS DATE))order by (EXTRACT(YEAR FROM usuario.dataaceite)), (EXTRACT(MONTH FROM usuario.dataaceite)), translate(to_char((CAST(usuario.dataaceite AS DATE)), 'MM-YYYY'),'-','/'));